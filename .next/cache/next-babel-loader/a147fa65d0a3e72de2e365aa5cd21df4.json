{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\nimport React, { Component, useContext, useEffect } from 'react';\nimport Link from 'next/link';\nimport Router from 'next/router';\nimport TopHeader from '../components/Layouts/TopHeader';\nimport Navbar from '../components/Layouts/Navbar';\nimport PageBanner from '../components/Common/PageBanner';\nimport FacilitySlider from '../components/Common/FacilitySlider';\nimport Footer from '../components/Layouts/Footer';\nimport Swal from 'sweetalert2';\nimport { UserContext } from '../contexts/UserContext';\n\nvar Login = function Login() {\n  var user = useContext(UserContext);\n  console.log(user);\n  useEffect(function () {\n    if (user.login === true) {\n      Router.push('/');\n    }\n  }, [user.login]);\n\n  var handleLogin = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n      var account, data, qs, query;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              e.preventDefault();\n              account = {\n                phoneNumber: e.target.elements.phoneNumber.value,\n                password: e.target.elements.password.value\n              };\n              qs = require('qs');\n              query = qs.stringify({\n                filters: {\n                  PhoneNumber: {\n                    $eq: account.phoneNumber\n                  }\n                },\n                populate: '*'\n              }, {\n                encodeValuesOnly: true\n              });\n              _context.next = 6;\n              return fetch(process.env.API_HOST + \"/api/accounts?\".concat(query)).then(function (response) {\n                return response.json();\n              }).then(function (res) {\n                if (res.data && res.data[0] && res.data[0].attributes) {\n                  if (res.data[0].attributes.Password === account.password) {\n                    data = res.data[0];\n                  }\n                }\n              });\n\n            case 6:\n              if (data) {\n                _context.next = 9;\n                break;\n              }\n\n              Swal.fire({\n                icon: 'error',\n                title: 'Đăng nhập không thành công',\n                text: 'Số điện thoại hoặc password không hợp lệ'\n              });\n              return _context.abrupt(\"return\");\n\n            case 9:\n              user.userLogin(data);\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleLogin(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(React.Fragment, null, __jsx(TopHeader, {\n    user: user\n  }), __jsx(Navbar, null), __jsx(PageBanner, {\n    pageTitle: \"T\\xE0i kho\\u1EA3n\",\n    homePageUrl: \"/\",\n    homePageText: \"Trang ch\\u1EE7\",\n    activePageText: \"\\u0110\\u0103ng nh\\u1EADp\"\n  }), __jsx(\"section\", {\n    className: \"login-area ptb-100\"\n  }, __jsx(\"div\", {\n    className: \"container\"\n  }, __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-lg-6 col-md-6\"\n  }, __jsx(\"div\", {\n    className: \"login-content\"\n  }, __jsx(\"h2\", null, \"\\u0110\\u0103ng nh\\u1EADp\"), __jsx(\"form\", {\n    onSubmit: handleLogin,\n    className: \"login-form\"\n  }, __jsx(\"div\", {\n    className: \"form-group\"\n  }, __jsx(\"input\", {\n    type: \"username\",\n    className: \"form-control\",\n    placeholder: \"Nh\\u1EADp s\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i\",\n    name: \"phoneNumber\"\n  })), __jsx(\"div\", {\n    className: \"form-group\"\n  }, __jsx(\"input\", {\n    type: \"password\",\n    className: \"form-control\",\n    placeholder: \"Nh\\u1EADp password\",\n    name: \"password\"\n  })), __jsx(\"button\", {\n    type: \"submit\",\n    className: \"default-btn\"\n  }, \"\\u0110\\u0103ng nh\\u1EADp\"), __jsx(\"div\", {\n    className: \"text-center\"\n  }, __jsx(Link, {\n    href: \"/forgot-password\"\n  }, __jsx(\"a\", {\n    className: \"forgot-password\"\n  }, \"Qu\\xEAn m\\u1EADt kh\\u1EA9u?\")))))), __jsx(\"div\", {\n    className: \"col-lg-6 col-md-6\"\n  }, __jsx(\"div\", {\n    className: \"new-customer-content\"\n  }, __jsx(\"h2\", null, \"Kh\\xE1ch h\\xE0ng m\\u1EDBi\"), __jsx(\"span\", null, \"T\\u1EA1o t\\xE0i kho\\u1EA3n m\\u1EDBi\"), __jsx(\"p\", null, \"T\\u1EA1o t\\xE0i kho\\u1EA3n m\\u1EDBi \\u0111\\u1EC3 ti\\u1EBFn h\\xE0nh mua s\\u1EA3n ph\\u1EA9m m\\u1ED9t c\\xE1ch d\\u1EC5 d\\xE0ng\"), __jsx(Link, {\n    href: \"/register\"\n  }, __jsx(\"a\", {\n    className: \"optional-btn\"\n  }, \"T\\u1EA1o t\\xE0i kho\\u1EA3n m\\u1EDBi\"))))))), __jsx(FacilitySlider, null), __jsx(Footer, null));\n};\n\nexport default Login;","map":null,"metadata":{},"sourceType":"module"}