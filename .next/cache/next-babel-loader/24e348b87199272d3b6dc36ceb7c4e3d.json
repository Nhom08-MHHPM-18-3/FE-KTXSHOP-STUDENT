{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport Router from 'next/router';\nimport StripeCheckout from 'react-stripe-checkout';\nimport { toast } from 'react-toastify';\n\nvar handleOrder = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(data) {\n    var timeElapsed, today;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            timeElapsed = Date.now();\n            today = new Date(timeElapsed);\n            fetch(process.env.API_HOST + \"/api/orders\", {\n              method: 'POST',\n              headers: {\n                'Content-Type': 'application/json'\n              },\n              body: JSON.stringify({\n                data: {\n                  AccountID: data.attributes.AccountID,\n                  Status: 'PROCESSING',\n                  CodeDiscount: '',\n                  ProductID: data.attributes.ProductID,\n                  Quantity: data.attributes.Quantity,\n                  UnitCost: data.attributes.UnitCost,\n                  Subtotal: data.attributes.Subtotal,\n                  PurchaseDate: today.toDateString()\n                }\n              })\n            }).then(function (response) {\n              return response.json();\n            }).then(function (data) {});\n\n          case 3:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function handleOrder(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar Payments = /*#__PURE__*/function (_React$Component) {\n  _inherits(Payments, _React$Component);\n\n  var _super = _createSuper(Payments);\n\n  function Payments() {\n    var _this;\n\n    _classCallCheck(this, Payments);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"handlePayment\", /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(cart, userData) {\n        var jwt;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                jwt = localStorage.getItem('jwt-ktxshop');\n                fetch(process.env.API_HOST + \"/api/accounts/\".concat(jwt), {\n                  method: 'PUT',\n                  headers: {\n                    'Content-Type': 'application/json'\n                  },\n                  body: JSON.stringify({\n                    data: {\n                      PhoneNumber: userData.phone.value,\n                      FullName: userData.fullName.value,\n                      Address: userData.address.value\n                    }\n                  })\n                }).then(function (response) {\n                  return response.json();\n                }).then(function (data) {\n                  console.log(data);\n                });\n                cart.cart.addedItems.map(function (item) {\n                  cart.removeItem(item.id);\n                  handleOrder(item);\n                });\n                toast.success('Đặt hàng thành công', {\n                  position: \"bottom-left\",\n                  autoClose: 5000,\n                  hideProgressBar: false,\n                  closeOnClick: true,\n                  pauseOnHover: true,\n                  draggable: true\n                });\n                setTimeout(_this.home, 2000);\n\n              case 5:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function (_x2, _x3) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"home\", function () {\n      Router.push('/');\n    });\n\n    return _this;\n  }\n\n  _createClass(Payments, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return __jsx(React.Fragment, null, __jsx(\"div\", {\n        className: \"order-btn\"\n      }, __jsx(\"button\", {\n        disabled: this.props.disabled,\n        className: \"default-btn\",\n        onClick: function onClick() {\n          return _this2.handlePayment(_this2.props.userData, _this2.props.stateSchema);\n        }\n      }, \"\\u0110\\u1EB7t h\\xE0ng\")));\n    }\n  }]);\n\n  return Payments;\n}(React.Component);\n\nexport default Payments;","map":null,"metadata":{},"sourceType":"module"}